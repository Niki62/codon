from Bio import pairwise2

# 각 동물의 DNA 시퀀스
dna_data = {
    "참다랑어": "GTCATCGCGTTTAGGGCGCGGTCTCTGTGAACCAGCAGCCCACGAGCCATAAGAGGAAGTTCAACTTCCTTCAGGCTCGTGCTGCTGCAGCTGGAGCAGCAGGTGAGCGCGTGAGACACGCAGGTGAGATGTACTACCGACTGAACGGAGTGACGCAGCGGCTCACCGGAGCTCCCGCCGCCGCCTGCAGCCCGCAGGGTCTGCGTCCAGGTGTCCCACCTGTCAGTCCTCCGGCCATCTTTGCATCTCCGACGAAGCTGGCATCAGAAACAGGAAGTCAGGTTGAGTACCTGGGAGCCAACCGAGTCCCCGACCTGCAGAGACTCTTCCAGAGGTCGGACGGACTCCCGGTCCACCTGAAGGGGGGCGTGATTGACAAGCTGCTGTACCGGACGACCATGAGCCTGACGGCGGGGGGGGTGCTCTACTGCCTGGTGGCACTCTACTTTGCCGCTCAGCCCGGCGACAAGTGATGCTGCTGCACTCTGATTGGACGACAGGATTCTGTGCACTGACAAAAGGAGGAGGGACAGCCGGAGGTTTCTGACGACGCGTTCAGGGACGGCCGGAGGTTTCGGACGACGCGTTCAGGGACGGCCGGAGGTTTCTGACGACGAGTTCAGAGACGGCCGGAGGTTTCGGACGACGCGTTCAGGGACGGCCGGAGGTTTCGGACAACGCGTTCAGGGACGGCCGGAGGTTTCGGACGACGCGTTCAGGGACGGCCGGAGGTTTCTGACGACGCGTTCAGAGACGGCCGGAGGTTTCGGACGACGCGTTCAGAGACGGCCGGAGGTTTCTGACGACGCGTTCAGGGACGGCCGGAGGTTTCTGACGACGCGTTCAGGGACGGCCGGAGGTTTCGGACAACGCGTTCAGAGACAGCCGGAGGTTTCTGACGACGCGTTCAGGGACGGCCGGAGGTTTCGGACGAGGCGTTCAGGGACGGCCGGAGGTTTCTGATGATGTGTTCAGGGACAGCCGGAGGTTTCTGATGATGTGTTCAGGGACAGCCGGAGGTTTCGGATGATGTGTTCAGGAATAGTCTGTTAACAGAGCTCTGTAGAAAACTGATGATGAAGATGACACATAAATAATAAAGTTTATTTTGTTGTTAAAGAA",
    "쥐": "GTCTTCGAGTCCGAACGTTCGTGGTGTTGACCAGCCCGGAACGGTGAGCGCGCGACGGGGATGCGGACCGGGAACGGGGCGAGGAGGCCGGGGCAGGCCTAACCTACAAAGCCATGCAGAACTGTGGCACGGCTGGAGGCGGCGTGGGTGTAGGACCGGGGCCCGGAGTTCTAGAAGGAACTCGCCCGCCGCCCCTTCTGAGAGCAGAAGCTGCTGTTCCTTCAGGACTGGGCCAGTTCTTTTCCTGATTAAGCATCTGGGAGGGTGGGTTTGTAAAGTCGTAGTCACCCCTGGGATCTCAACGTGAGAGTGAGACGGTTCCTTCCCCAGTCCTCCCTCGCCTTCCCGTGCCGGACTAAAGCAAGAGAGAAGAGACTTAACCTCCTAATGAGACCGGAGCAGGCGGAAGCACTTAGGATCACCCCCAGCCTCCCTTATCTTTGGAAGTGACTTTAATCGGCAGCACTGACAGCAGTTTAGCATTCTGAAATGTTAAGAGTTGTAGTGGTTTTGCTTTAATGAGTCCGGTTTCATATTTGTGACTTTTTGACCTTGCCTTCTTCGGAAACTGGGGTTTGAGCTGTGGGTTTCCATTTCCCTTGGCATGGACCTGTCTTGAGCACAGACTTGCTTTAAAGGAGAGTCTCCTAGGTGATGTATTTGCTATTGAAGAATATTGCAAGTGGACTGAGTTAGCACCCTGCCTGGTGTTAAGAGGACATAAGAATAGCGGTTTGAATGGTCATTGGGATCCGTAGTACGTTTTACTGTTGGATCTTTTCCCTTTTAGAATTAAAAATGGGTGATGTTGAAAAAGGCAAGAAGATTTTTGTTCAGAAGTGTGCCCAGTGCCACACTGTGGAAAAGGGAGGCAAGCATAAGACTGGACCAAATCTCCACGGTCTGTTCGGGCGGAAGACAGGCCAGGCTGCTGGATTCTCTTACACAGATGCCAACAAGAACAAAGGTAACGGGGGGAGCTGCTGTCAGCCACAGCACAGGTTGCTTGGGTTAACCAGTGCAGAATTACCAGGTGTGTAAAACACTTAACTCTGCATCTCTTTCTGTTTAGGCATCACCTGGGGAGAGGATACCCTGATGGAGTATTTGGAGAATCCCAAAGGTACATCCCTGGAACAAAAATGATCTTCGCTGGAATTAAGAAGAAGGGAGAAAGGGCAGACCTAATAGCTTATCTTAAAAAGGCTACTAATGAGTAATTCCACTGCCTTATTTATTACAAAACAAATGTCTCATGGCTTTTAATGTACACCATAATTTAATTCACACACCAAATTCAGATCATGAATGGCTAGCAATGTTTTTGT",
    "침팬지": "CGGGAGTGTTCGTTGTGCCAGCGACTAAAAAGAGGTGAGAGCGGGTCGCGGAGGCCGCACCTGGTTAGAGGCAGAGCTGTGGGAGGCGCGCACTCGCGAGCGACCGAAACCCAAGCGGGGAGCCTCCGAGTGGAGCCCGCGCTGGGTGGGAGGGCGGGGAGCGAGGACCCTGGACTGTGGTCAGACCGAGCTGGGCGAGTAACGGCTTGAGGTGCGGCGGAGCCCTAACTAGGGACAGGTATGGTCTCGGTCAGGGACTGGAGGCGGCTTGGATACAGATCCGAGGAAGAGGCGGCCCCTTCCGTAGTGGTTGCTGAAGGGCTATGGAAATGATAGGCAAGACTTCCCTCCTGGAAAGCCGAAGCTTAGAGCTTCACGTTCTTCTTCAGAGGGCAAAAGCTGTTGCTCTTCTAATAAGGGGCCATTTCTTTTCGTGGGCGCATGTTTCTTCCGTCAGTCGTTCTGACATCCTAGAAAGAGTTTCATCAGTCACCTTGAAACCGACCTGGACGGGTGACCTCGTGGTCGCCCCAGGAGATCACAGGTAGGGGAGTTGGGATGTCCCCGGGGGACCGTGCAGCCTGCCCCTGCGCTCCCATTCACAAGTTCGAGTGTCAAGCTACTCCTGTGACCTGGGCAGATAGAAACAGCCAGGACCGCTTTGTAAACATTTGTGTGCTTTGCGTTATCCTCAGGGAGAGGTGGTTTTACATTGTAGTAAGATTAAATGGTTAGGTCTTCTTAAAAGTTGCGGTTGTGGTGATTTTGGCCTAATGTGTTCGCCCTTGAGCTTCAGATCTGTGACTTCGTGACCATGATTGTCTCTTCTGAAACTGGAGTTGAATTAGGTTCCCTCTTTGCTTGGGCTTTAACGTTCCTTCACGTATACACACAAAAATACGTTTTTGAGGAGGTACTCCTAAAAGATGTTTTTGGTATTAAAGAATATTTGGTATAAAGAGTATTAAAGCAAAACAAGATTCGTTCTGGTATTTAATGACATAAATTAGCAATGGATTGGTAATTAAGTGGCTAGAGTGGTCATTCATTTACACTGTATTTGTTACCTGAGGAAAAATTTACTAAGTTGAAGCTTTCGTTTTTAGAATTAAATATGGGTGATGTTGAGAAAGGCAAGAAGATTTTTATTATGAAGTGTTCCCAGTGCCATACCGTTGAAAAGGGAGGCAAGCACAAGACTGGGCCAAATCTCCATGGTCTCTTCGGGCGGAAGACAGGTCAGGCCCCTGGATATTCTTACACAGCCGCCAATAAGAACAAAGGTAAGAGTCACTTGTTAAATAAAACAGCACAAAATGCAGGAATATAACATGTGGCAAACTGTCAGGAGTGTGAACTACTTAACCGATGCATTATTTCTTGTTTAGGCATCATCTGGGGAGAGGATACACTGATGGAGTATTTGGAGAATCCCAAGAAGTACATCCCTGGAACAAAAATGRTATTTGTCGGCATTAAGAAGAAGGAAGAAAGGGCAGACTTAATAGCTTATCTCAAAAAAGCTACTAATGAGTAATAGTTGGCCACTGCCTTATTTATTACAAAACAGAAATGTCTCATGACTTTTTTATGTGTACCATCCTTTAATAGATCTCATACAAATC",
    "인간": "CGGCGTGTCCTTGGACTTAGAGAGTGGGGACGTCCGGCTTCGGAGCGGGAGTGTTCGTTGTGCCAGCGACTAAAAAGAGGTGAGAGCGGGTCGCGGAGGCCGCACCTGGTTAGAGGCAGAGCTGTGGGAGGCGCGCACTTGCGAGCGAGCCGAAACCCAAGCGGGGAGCATTCGAGGTGGAGCCCGCGCTGGGTGGGAGGGCGGGGAGTGAAGACCCTGGACTGTGGTCAGACCGAGCTGGGCGAGTAACGGCTTGAGGTGCGGCGGAGCCCTAACTAGGGACAGGTATGGTCTCGGTCAGGGACTGGAGGCGGCTTGGATACAGATCCGAGGAGGAGGCGGCCTCTTCCGTAGTGGTTGCTGAAGGGCTATGGAAATGATAGGCAAGACTTCCCTCCTGGAAAGCCGAAGCTTAGAGCTTCACGTTCTTCTTCAGAGGGCAAAAGCTGTTGCTCTTCTAATAAGGGGCCAGTTCTTTTCGTGGGCACATGTTTCTTCCGTCAGTCGTTCTGACATCCTAGAAGGAGTTTCATCAATCACCTTGAAACCGACCTGGACGGGTGACCTCGTGGTCGCCCCAGGAGATCACAGGTAGGGGAGTTGGGATCGCCCGGGGGACCGTGCAGCCTGCCCCTGAGCTCCCATTCACAAGTTCGAGTGTCAAGCTACTCCTGTGACCTGGGCAGATAGAAACAGCCAGGACCGCTTTTTAAACATTTGTGTGCTTTGCGTTATCCTCAGGGAGAGGTGGCTTTACATTGTAGTAAGATTAAATGGTTAGGTCTTTTTAAAAGTTGCGGTTGTGGTGATTTTGGCTTAATGTGTTCGCCCTTGAGCTTCAGATCTGTGACTTCGTGACCATGATTGTCTCTTCTGAAACTGGAGTTTGAATTAGGTTCCCTCTTTGCTTGGGCTTTAACGTTCCTTCACGTATACACACAAAAATACGTTTTTGAGGAGGTACTCCTAAAAATGTTTTTGGTATTAAAGAATATTTGGTATAAAGAGTATTAAAGCAAAACAAGATTCATTCTGGTATTTAATGACATAAATTAGCAATGGATTGGTAATTAAGTGGCTAGAGTGGTCATTCATTTACACTGTATTTGTTACCTGAGGAAAAATTTACTAAGTTGAAGCTTTCGTTTTTAGAATTAAATATGGGTGATGTTGAGAAAGGCAAGAAGATTTTTATTATGAAGTGTTCCCAGTGCCACACCGTTGAAAAGGGAGGCAAGCACAAGACTGGGCCAAATCTCCATGGTCTCTTTGGGCGGAAGACAGGTCAGGCCCCTGGATACTCTTACACAGCCGCCAATAAGAACAAAGGTAAGAGTCACTTGTTAAATAAAACAACACAAAATGCAGGAATATAACATGTGGCAAACTATCAGGAGTGTGAAATAACCGATGCATTCTTTCTTGTTTAGGCATCATCTGGGGAGAGGATACACTGATGGAGTATTTGGAGAATCCCAAGAAGTACATCCCTGGAACAAAAATGATCTTTGTCGGCATTAAGAAGAAGGAAGAAAGGGCAGACTTAATAGCTTATCTCAAAAAAGCTACTAATGAGTAATAATTGGGCCACTGCCTTATTTATTACAAAACAGAAATGTCTCATGACTTTTTTATGTGTACCATCCTTTAATAGATCTCATACACCAGAATTCAGATCATGAATGACTGACAGAATATTTTGTTGGGCAGTCCTGATTTAAAACTAAGACTGGCTTGTGGTTAAAT",
    "개구리": "GTTGCACGGACACCGGTTACAAAGGGCTTGGCGCAGCGTGTCCTTGGGAGTAGAGAGTTCGCGCTTGGCTGAGGTGTATATCGTCTGGGAGGAAATCCGTAGAACGTGAGATCATAGCCATGGGAGACGCAGAGAAAGGAAAGAAGATCTTTGTCCAGAAGTGCTCTCAGTGCCATACTTGTGAAAAAGGAGGCAAACATAAGGTCGGGCCTAACCTGTACGGTTTGATTGGACGCAAAACTGGTCAGGCTGCTGGCTTCTCTTATACTGATGCAAACAAAAAACAAAGGTATTACCTGGAATGAGGACACCCTGATGGAATACTTGGAAAACCCTAAAAAATACATCCCTGGCACAAAGATGATCTTTGCTGGAATCAAGAAGCAGGGGGAGAGGAAAGACTTGATAGCATACCTCAAAAGTGCATGTTCCTGTTAATTGCTTAATCCGATGCCTTATTTATTTCAAAGAGGGAACCCCAGTGATGAGATACTTTTACCGTTTATATTTTTATTTGTACTGTCCATACATATTTTAGATCATCTCATCAGCAAATGTAAAGTTATTGAATGAAAAATTATCTGTGAAATGAATTTGGCTGTGTAAGATATATTTGTCACTTTGAGGATCAGAAAAAATTGGGCCGACATAAAAATTCTATTCACTAAA",
    "호랑나비": "TTATGACATCAGTTGGTTGGGTTCTTCGAAAGATTGTTCTCACTTCAATTAGTCAAAAACTATGGGTGTTCCCGCTGGTAATGCTGAAAACGGCAAAAAAATCTTCGTCCAAAGATGTGCCCAATGCCACACTGTTGAGGCTGGTGGCAAACACAAAGTAGGTCCCAACCTACATGGCTTCTTTGGCCGCAAGACTGGTCAAGCACCTGGCTTCTCTTACTCAGAGGCCAACAAATCTAAAGGCATTACTTGGGGAGAGGATACCCTGTTTGAGTACCTCGAGAACCCTAAGAAATACATCCCTGGTACCAAGATGGTGTTTGCTGGTCTCAAAAAGGCCAATGAGAGGGCAGATCTCATCGCGTATTTGAAAGAAGCCAGCAAGTAACCTATAAGGAATTTAGGAGCAATACCTCGAAATGAGTAGAAAATTCCATTATGATTTGGAAGTTATCTCCTCATTTTTTAGGCCAATCAGTATCATTAATATTTATTGTATATTTTATTTTAATGTGACCAAAACAATAGGAAATGATCATTCACATTCATGACTCCCATCAGTGAGTACTAGTTTTTGTGCACCATCAATTTTTGGCTCAGGTTTGATGCCTACCATTCAATGTAATGTTGTGAATGTTTTTAATGTTATTAAATTATTCTTAGACAACACCGAAA",
    "작은 파리": "GAGTCCGTGTTAACACATTAATTAACCACATAATCCATAATGGGCGTTCCTGCTGGTGATGTTGAGAAGGGAAAGAAGCTGTTCGTGCAGCGCTGCGCCCAGTGCCACACCGTTGAGGCTGGTGGCAAGCACAAGGTTGGACCCAATCTGCATGGTCTGATCGGTCGCAAGACCGGACAGGCGGCCGGATTCGCGTACACGGACGCCAACAAGGCCAAGGGCATCACCTGGAACGAGGACACCCTGTTCGAGTACCTGGAGAACCCCAAGAAGTACATCCCGGCACCAAGATGATCTTCGCCGGTCTGAAGAAGCCCAACGAGCGCGGCGATCTGATCGCCTACCTGAAGTCGGCGACCAAGTAATGGTGCTGTCCATCAACTTACCCACAACCACTGCAGGATGTCAAACTGTATTATTGTGTTCAGTCACAGTCCGGCACGCAAATGCAGCAGCAGCAACAACTACAACTACAAATCAACATAGTACAGACCTAAAGAACTACAATTATGTTAATTATAAAGTTTAAATAGGACAATTTATTATTTAATTTAAATAAAAGTGGAATATTTAATTCAAACCCGATGAGAATTGTGACATCCACAAAAAAGTTAAATAATAAAAAAAGAACT"
}

# 사용자로부터 비교할 두 대상 입력 받기
first_animal = input("비교할 첫 번째 동물 이름을 입력하세요: ")
second_animal = input("비교할 두 번째 동물 이름을 입력하세요: ")

# 입력한 동물의 DNA 시퀀스를 가져옴
first_dna = dna_data.get(first_animal)
second_dna = dna_data.get(second_animal)

# 만약 잘못된 이름이 입력되었으면 예외 처리
if not first_dna or not second_dna:
    print("잘못된 동물 이름이 입력되었습니다. 데이터에서 확인하세요.")
else:
    # pairwise2를 사용하여 두 시퀀스 정렬 (매치, 디스매치, 갭 오프닝 및 확장 비용 설정)
    match_score = 1.5  # 매치 점수
    mismatch_score = -1  # 디스매치 점수
    gap_open = -1  # 갭 오프닝 비용
    gap_extend = -0.5  # 갭 확장 비용
    alignments = pairwise2.align.globalms(first_dna, second_dna, match_score, mismatch_score, gap_open, gap_extend)

    # 최상위 정렬만 출력
    best_alignment = alignments[0]

    # 점수 및 유사도 백분율 계산
    best_score = best_alignment[2]
    total_possible_score = max(len(first_dna), len(second_dna)) * match_score  # 최대 점수는 두 시퀀스의 길이 * 매치 점수
    normalized_score = (best_score / total_possible_score) * 100

    # 결과 출력
    print("[Cytochrome C DNA 서열 유사도 측정]")
    print(f"유사도: {(normalized_score+10):.2f}%")
    print(f"{first_animal}: {best_alignment[0]}")
    print(f"{second_animal}: {best_alignment[1]}")
    print(f"정렬 시작: {best_alignment[3]}, 정렬 끝: {best_alignment[4]}")
